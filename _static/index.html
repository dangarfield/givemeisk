<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Give Me ISK</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <style>
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: min-content 1fr auto ;
            height: 100%;
        }
        .grid-2-3 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: min-content auto 1fr auto ;
            height: 100%;
        }
        .grid-info {
            grid-area: 1 / 1 / 1 / 2;
        }
        .grid-validation {
            grid-area: 1 / 2 / 1 / 3;
        }
        .grid-userinput {
            grid-area: 2 / 1 / 2 / 3;
        }
        .grid-pasteinput {
            grid-area: 2 / 1 / 2 / 3;
        }
        .grid-output {
            grid-area: 3 / 1 / 3 / 3;
        }
        .align-self {
            align-self: center;
        }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <img src="/isk.png" alt="Bootstrap" width="26" height="26">
                Give Me ISK!
            </a>
            <div class="collapse navbar-collapse">
                <span class="navbar-text">
                    Configure your giveaway
                </span>
            </div>
        </div>
    </nav>

      
    <div class="container">
        <div class="row my-3">
            <div class="col-3">
                <div class="input-group form-floating mb-3">
                    <input type="text" class="form-control discord-key" id="discord-key" placeholder="Discord Key goes here...">
                    <label for="discord-key">Discord Bot Key</label>
                    <button class="btn btn-outline-secondary discord-key-button" type="button">Select</button>
                </div>
                <div class="input-group form-floating mb-3">
                    <select class="form-select guild" id="guild" disabled>
                        <option>Select your guild...</option>
                    </select>
                    <label for="guild">Guild</label>
                </div>
                <div class="input-group form-floating mb-3">
                    <select class="form-select channel" id="channel" disabled>
                        <option>Select your channel...</option>
                    </select>
                    <label for="channel">Channel</label>
                </div>

                <div class="dropdown w-100 blacklist-dropdown mb-3">
                    <button class="btn btn-outline-secondary dropdown-toggle w-100 mb-3" type="button" data-bs-toggle="dropdown" aria-expanded="false" disabled>
                        Select members to blacklist
                    </button>
                    <ul class="dropdown-menu w-100">
                        <input class="form-control member-search" type="text" placeholder="Search..">
                        <li><button class="dropdown-item member active">Action</button></li>
                        <li><button class="dropdown-item member">Another action</button></li>
                        <li><button class="dropdown-item member">Something else here</button></li>
                    </ul>
                    <div class="blacklist-holder">
                    </div>
                </div>                      

                <div class="input-group mb-3">
                    <label for="giveaway-gap" class="form-label w-100">Gap Between Giveaways<span class="float-end"><span class="giveaway-gap-text">30</span> secs</span></label>
                    <input type="range" class="form-range giveaway-gap" min="1" max="120" step="1" id="giveaway-gap" value="30">
                </div>
                <div class="form-floating mb-3">
                    <textarea type="text" class="form-control default-prize-message" id="default-prize-message" style="height:100px;">Woohoo! @user just won something shiny! @prize</textarea>
                    <label for="default-prize-message">Default Prize Message</label>
                </div>                  
                <div class="form-check form-switch mb-3">
                    <input class="form-check-input dry-run" type="checkbox" role="switch" id="dry-run" checked>
                    <label class="form-check-label" for="dry-run">Dry Run <i>(No msg to discord)</i></label>
                </div>
                <div class="form-check form-switch mb-3">
                    <input class="form-check-input black-to-white" type="checkbox" role="switch" id="black-to-white">
                    <label class="form-check-label" for="black-to-white">Make blacklist a whitelist</label>
                </div>
                <div class="mb-3 w-100">
                    <button type="button" class="btn btn-outline-primary start w-100" disabled>Select bot key before start</button>
                </div>
            </div>
            <div class="col">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <button class="nav-link active" data-tab="instructions">Instructions</button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-tab="countdown">Countdown</button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-tab="countafter">Countafter</button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-tab="prizes">Prizes</button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-link" data-tab="results">Results</button>
                    </li>
                </ul>
                <div class="stretch">
                    <div class="tab h-100 border p-3" data-tab="instructions">
                        <h3>Setup Bot</h3>
                        <p>TODO - I will fill this out later, but basically you need a discord bot key with the permissions to view your guild, channel, members and post messages. Add this bot to your guild.</p>

                        <h3>Giveaway Setup</h3>
                        <ul>
                            <li>After your've put your discord key in, select your guild and channel</li>
                            <li>All changes are saved to your browser automatically. No data is sent to anywhere except discord APIs</li>
                            <li>Blacklist any members</li>
                            <li>You can execute a DRY RUN without sending any messages to discord, it'll be quicker</li>
                            <li>Conversely, if you don't see anything on discord, check for this!</li>
                            <li>Add messages for before and after your giveaway with COUNTDOWN and COUNTAFTER</li>
                            <li>Copy and paste your spreadsheet into the prizes column</li>
                            <li>Once finished, you can view the results</li>
                            <li>IMPORTANT: This runs in your browser, if you get disconnected, refresh the page and you can start from where you last sent messages</li>
                            <li>Source code available: <a href="https://github.com/dangarfield/givemeisk">github.com/dangarfield/givemeisk</a></li>
                            <li>I will make this instruction page prettier...</li>
                        </ul>
                        
                    </div>
                    <div class="tab h-100 border p-3" data-tab="countdown" style="display: none;">
                        <div class="grid-2 column-gap-3">
                            <div class="alert alert-info grid-info">
                                Write text. Each line will be printed out each second BEFORE for the giveaway. Empty lines will be ignored.
                            </div>
                            <div class="alert alert-light grid-validation">
                                Make a change below. Validation will display automatically
                            </div>
                            <div class="form-floating grid-userinput">
                                <textarea class="form-control h-100 countdown" placeholder="Countdown" id="countdown"></textarea>
                                <label for="countdown">Countdown</label>
                            </div>
                        </div>
                    </div>
                    <div class="tab h-100 border p-3" data-tab="countafter" style="display: none;">
                        <div class="grid-2 column-gap-3">
                            <div class="alert alert-info grid-info">
                                Write text. Each line will be printed out each second AFTER for the giveaway. Empty lines will be ignored.
                            </div>
                            <div class="alert alert-light grid-validation">
                                Make a change below. Validation will display automatically
                            </div>
                            <div class="form-floating grid-userinput">
                                <textarea class="form-control h-100 countafter" placeholder="Countafter" id="countafter"></textarea>
                                <label for="countafter">Countafter</label>
                            </div>
                        </div>
                    </div>
                    <div class="tab h-100 border p-3" data-tab="prizes" style="display: none;">
                        <div class="grid-2-3 column-gap-3 row-gap-3">
                            <div class="alert alert-info m-0 grid-info">
                                Paste your excel sheet in here, inc. header. 5 columns:
                                <ol class="m-0">
                                    <li><code>Prize</code></li>
                                    <li><code>No of prizes</code></li>
                                    <li><code>Items in each prize</code> Optional: Default is 1</li>
                                    <li><code>Prize msg</code> Optional: Include @user and @prize</li>
                                    <li><code>Sponsored msg</code> Optional</li>
                                </ol>
                                  
                            </div>
                            <div class="alert alert-light m-0 grid-validation">
                                Paste your sheet here. Validation will display automatically
                            </div>
                            <div class="form-floating grid-pasteinput">
                                <textarea class="form-control h-100 prizes" placeholder="Prizes" id="prizes"></textarea>
                                <label for="prizes">Paste excel sheet here</label>
                            </div>
                            <div class="grid-output d-flex">
                                <h3 class="text-center align-self w-100 text-muted"><i>Paste your spreadsheet to continue</i></h3>
                            </div>
                        </div>
                    </div>
                    <div class="tab h-100 border p-3" data-tab="results" style="display: none;">
                        <div class="grid-2-3 column-gap-3 row-gap-3">
                            <div class="alert alert-info grid-info">
                                <b>DO NOT REFRESH YOUR BROWSER!</b><br/>
                                Results will be displayed as the giveaway progresses. If anything went wrong, you can restart the giveaway from the last message.
                                You can clear the results if you want to start again<br/>
                                <b>BEFORE RUNNING A GIVEAWAY - TAKE CARE TO BOOKMARK THE ADMIN LINK</b>
                            </div>

                            <div class="form-floating grid-pasteinput">
                                <textarea class="form-control h-100 last-msg-sent" placeholder="Last Message Sent" id="last-msg-sent" disabled></textarea>
                                <label for="last-msg-sent">Last Message Sent</label>
                            </div>
                            <div class="alert alert-light grid-validation">
                                <button class="btn btn-outline-primary results-restart mb-1" disabled>Select bot key before restart from last message</button>
                                <button class="btn btn-outline-primary results-clear mb-1">Clear results</button>
                                <button class="btn btn-outline-primary mb-1" id="result-sort-order">
                                    Sort: <span id="sort-order" data-order="giveaway">Giveaway</span>
                                </button>
                                <a class="btn btn-outline-primary mb-1 giveaway-admin-link" href="/admin?id=" target="_blank" disabled>Open giveaway admin</a>
                                <span class="result-progress"></span>
                            </div>
                            <div class="grid-output d-flex">
                                <h3 class="text-center align-self w-100 text-muted"><i>Start giveaway to see results</i></h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
    <script src="client.min.js"></script>
  </body>
</html>